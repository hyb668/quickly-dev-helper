	//xml中
	<android.support.design.widget.TabLayout
        android:id="@+id/tl_category_bar"
        android:layout_width="0dp"
        android:layout_height="0dp"
        app:tabIndicatorColor="@color/zuti"
        />
    <android.support.v4.view.ViewPager
        android:id="@+id/vp_category_pagers"
        android:layout_width="0dp"
        android:layout_height="0dp"
        android:layout_below="@id/tl_category_bar"
        />
	
	
	//Activity代码
	private List<Fragment> fragments = new ArrayList<>();
    private List<String> tabTitles = new ArrayList<>();
    private AllOrderViewPagerAdapter adapter;
	
	protected void initUi() {
        
        TabLayout titleBar = (TabLayout) findViewById(R.id.tl_category_bar);
        ViewPager vpCategory = (ViewPager) findViewById(R.id.vp_category_pagers);
        adapter = new AllOrderViewPagerAdapter(getSupportFragmentManager(), fragments, tabTitles);
        vpCategory.setAdapter(adapter);
        titleBar.setupWithViewPager(vpCategory);
		
		//下面可以设置每个tab布局
        for (int i = 0; i < titleBar.getTabCount(); i++) {
            TabLayout.Tab tab = titleBar.getTabAt(i);
            if (tab != null) {
                View tabView = LayoutInflater.from(getActivity()).inflate(R.layout.tab_order, null);
                ImageView ivOrder = (ImageView) tabView.findViewById(R.id.iv_tab_order);
                TextView tvOrder = (TextView) tabView.findViewById(R.id.tv_tab_order);
                ivOrder.setImageResource(tabIcons[i]);
                tvOrder.setText(tabTitles.get(i));
                tab.setCustomView(tabView);
            }
        }
    }
	
	private void updateCategoryTitle(String data) {
        tabTitles.clear();
        fragments.clear();
        for (int i = 0; i < categorys.size(); i++) {
			//todo
            ProductCategory.DataEntity entity = categorys.get(i);
            tabTitles.add(entity.getCategory_name());
            CategoryFragment categoryFragment = new CategoryFragment();
            fragments.add(categoryFragment);
        }
        adapter.notifyDataSetChanged();
    }
	
	//Adapter
	public class AllOrderViewPagerAdapter extends FragmentPagerAdapter {

    private List<Fragment> fragments;
    private List<String> titles;

    public AllOrderViewPagerAdapter(FragmentManager fm, List<Fragment> fragments, List<String> titles) {
        super(fm);
        this.fragments = fragments;
        this.titles = titles;
    }

    @Override
    public Fragment getItem(int position) {
        return fragments.get(position);
    }

    @Override
    public int getCount() {
        return fragments == null ? 0 : fragments.size();
    }

    //此方法用来显示tab上的名字
    @Override
    public CharSequence getPageTitle(int position) {

        return titles.get(position % titles.size());
    }
}
